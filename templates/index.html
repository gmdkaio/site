{% extends 'base.html' %}

{% block head %}
    <title>Filter Maquinas</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
{% endblock %}

{% block body %}
    <h1>Monte sua Máquina</h1>
    <h3>Utilize nosso site e descubra qual a máquina ideal para o seu produto</h3>
    <form id="filter-form">
        <section class="grid main-grid">
            <section class="grid grid-embalagens">
                <div class="item nav"><div class='texto'>Selecione uma embalagem</div></div>
                <div class="item content">
                    <button type="button" class="embalagem-btn" value="1"><img src="../static/images/embalagens/gabletop.png" alt="Gable Top"></button>
                    <button type="button" class="embalagem-btn" value="2"><img src="../static/images/embalagens/pouch.png" alt="Stand-Up Pouch"></button>
                    <button type="button" class="embalagem-btn" value="3"><img src="../static/images/embalagens/especiais.png" alt="Especiais"></button>
                    <button type="button" class="embalagem-btn" value="4"><img src="../static/images/embalagens/sache.png" alt="Sachê"></button>
                    <button type="button" class="embalagem-btn" value="5"><img src="../static/images/embalagens/garrafa.png" alt="Garrafa"></button>
                    <button type="button" class="embalagem-btn" value="6"><img src="../static/images/embalagens/frasco.png" alt="Frasco"></button>                        <button type="button" class="embalagem-btn" value="7"><img src="../static/images/embalagens/fardo.png" alt="Fardo"></button>
                    <button type="button" class="embalagem-btn" value="8"><img src="../static/images/embalagens/pote.png" alt="Pote"></button>
                </div>
            </section>
            <section class="grid grid-produtos">
                <div class="item nav"><div class='texto'>Selecione um tipo de produto</div></div>
                <div class="item content">
                    <button type="button" class="produto-btn" value="1"><img src="../static/images/produtos/liquido-fino.png" alt="Líquido fino"></button>
                    <button type="button" class="produto-btn" value="2"><img src="../static/images/produtos/liquido-medio.png" alt="Líquido médio"></button>
                    <button type="button" class="produto-btn" value="3"><img src="../static/images/produtos/liquido-viscoso.png" alt="Líquido viscoso"></button>
                    <button type="button" class="produto-btn" value="4"><img src="../static/images/produtos/pos.png" alt="Pó"></button>
                    <button type="button" class="produto-btn" value="5"><img src="../static/images/produtos/granular.png" alt="Granular"></button>
                    <button type="button" class="produto-btn" value="6"><img src="../static/images/produtos/solidos.png" alt="Sólido"></button>   
                </div>
            </section>
        </section>
        <br>
        <button type="submit">Filter</button>
    </form>
    <h2>Results:</h2>
    <ul id="result-list"></ul>

    <!-- <label for="producao" id="producao">Velocidade de produção</label>
    <br>
    <select>
        <option value=1000>Producao 1</option>
        <option value=2000>Producao 2</option>
        <option value=3000>Producao 3</option>
        <option value=4000>Producao 4</option>
    </select> -->
    <script>
        var embalagem = 0;
        var produto = 0;

        $('.embalagem-btn').click(function() {
            embalagem = parseInt($(this).val());
            setFilterValues();
        });

        $('.produto-btn').click(function() {
            produto = parseInt($(this).val());
            setFilterValues();
        });

        $('#filter-form').submit(function(event) {
            event.preventDefault();

            var formData = {
                embalagem: embalagem,
                produto: produto
            };

            $.ajax({
                type: 'POST',
                url: '/filter',
                data: formData,
                success: function(response) {
                    var result = response.result;
                    var resultHtml = '';

                    if (result.length === 0) {
                        resultHtml = '<li>Nenhum resultado encontrado</li>';
                    } else {
                        for (var i = 0; i < result.length; i++) {
                            resultHtml += '<li>' + result[i] + '</li>';
                        }
                    }

                    $('#result-list').html(resultHtml);
                },
                error: function(error) {
                    console.log('Error:', error);
                }
            });
        });

        function setFilterValues() {
            $('#embalagem').val(embalagem);
            $('#produto').val(produto);
        }

        const embButtons = document.querySelectorAll('.embalagem-btn');
        const prodButtons = document.querySelectorAll('.produto-btn');

        embButtons.forEach(button => {
        button.addEventListener('click', function() {
            const isActive = this.classList.contains('active');
            embButtons.forEach(btn => btn.classList.remove('active'));
            if (!isActive) {
            this.classList.add('active');
            embalagem = parseInt(this.value);
            } else {
            embalagem = 0;
            }
            setFilterValues();
  });
});

        prodButtons.forEach(button => {
        button.addEventListener('click', function() {
            const isActive = this.classList.contains('active');
            prodButtons.forEach(btn => btn.classList.remove('active'));
            if (!isActive) {
            this.classList.add('active');
            produto = parseInt(this.value);
            } else {
            produto = 0;
            }
            setFilterValues();
    });
});
    </script>
{% endblock %}
